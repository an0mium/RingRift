Latency tracker module loaded
Bandwidth monitor module loaded
Lifeguard enhancement module loaded
Metrics collector module loaded
INFO:app.p2p.swim_adapter:swim-p2p loaded successfully (SWIM membership available, TCP+UDP transports)
INFO:app.config.unified_config:Loaded unified config from /Users/armand/Development/RingRift/ai-service/config/unified_loop.yaml
INFO:app.config.unified_config:  Training threshold: 200
INFO:app.config.unified_config:  Elo DB: data/unified_elo.db
2026-01-16 22:57:52,148 - app.coordination.safeguards - INFO - Safeguards initialized
/Users/armand/.pyenv/versions/3.10.13/lib/python3.10/site-packages/paramiko/pkey.py:100: CryptographyDeprecationWarning: TripleDES has been moved to cryptography.hazmat.decrepit.ciphers.algorithms.TripleDES and will be removed from cryptography.hazmat.primitives.ciphers.algorithms in 48.0.0.
  "cipher": algorithms.TripleDES,
/Users/armand/.pyenv/versions/3.10.13/lib/python3.10/site-packages/paramiko/transport.py:259: CryptographyDeprecationWarning: TripleDES has been moved to cryptography.hazmat.decrepit.ciphers.algorithms.TripleDES and will be removed from cryptography.hazmat.primitives.ciphers.algorithms in 48.0.0.
  "class": algorithms.TripleDES,
2026-01-16 22:57:57,435 - p2p_orchestrator - WARNING - [P2P] Port 8770 occupied but unresponsive: <urlopen error timed out>
2026-01-16 22:57:57,436 - p2p_orchestrator - WARNING - [P2P] Detected zombie P2P process on port 8770, killing PIDs: [83710, 91834, 92744, 95863]
2026-01-16 22:57:57,539 - p2p_orchestrator - INFO - [P2P] Killed zombie process PID 83710
2026-01-16 22:57:57,539 - p2p_orchestrator - INFO - [P2P] Killed zombie process PID 91834
2026-01-16 22:57:57,539 - p2p_orchestrator - INFO - [P2P] Killed zombie process PID 92744
2026-01-16 22:57:57,539 - p2p_orchestrator - INFO - [P2P] Killed zombie process PID 95863
[P2P] Killed zombie P2P process, proceeding with startup
2026-01-16 22:57:58,040 - p2p_orchestrator - INFO - [P2P] Acquired singleton lock (PID 2396)
2026-01-16 22:57:58,129 - p2p_orchestrator - INFO - [NODE-ID] Resolved node ID via tailscale: local-mac
2026-01-16 22:57:58,129 - p2p_orchestrator - INFO - Auto-detected node-id: local-mac
2026-01-16 22:57:58,129 - p2p_orchestrator - INFO - Initializing P2P orchestrator: node_id=local-mac
2026-01-16 22:57:58,129 - p2p_orchestrator - INFO - Bootstrap seeds: 0 CLI + 5 hardcoded = 5 total
2026-01-16 22:57:58,179 - p2p_orchestrator - INFO - Auto-detected storage: DISK (RAM: 128GB, Disk: 380GB free / 59% used)
2026-01-16 22:57:58,192 - app.utils.ramdrive - INFO - ============================================================
2026-01-16 22:57:58,192 - app.utils.ramdrive - INFO - STORAGE AUTO-DETECTION REPORT
2026-01-16 22:57:58,192 - app.utils.ramdrive - INFO - ============================================================
2026-01-16 22:57:58,192 - app.utils.ramdrive - INFO - System RAM:     128.0GB total, 89.6GB available
2026-01-16 22:57:58,192 - app.utils.ramdrive - INFO - Disk:           926.4GB total, 379.7GB free (59.0% used)
2026-01-16 22:57:58,192 - app.utils.ramdrive - INFO - Ramdrive:       /tmp - 379.7GB free
2026-01-16 22:57:58,192 - app.utils.ramdrive - INFO - RAM-rich:       Yes
2026-01-16 22:57:58,192 - app.utils.ramdrive - INFO - Disk-limited:   No
2026-01-16 22:57:58,192 - app.utils.ramdrive - INFO - Recommendation: USE DISK
2026-01-16 22:57:58,192 - app.utils.ramdrive - INFO - ============================================================
2026-01-16 22:57:58,224 - p2p_orchestrator - INFO - [P2P] Using YAML config tailscale_ip: 100.69.164.58
[P2P] Voter quorum enabled: voters=7, quorum=2 (local-mac, hetzner-cpu1, hetzner-cpu2, hetzner-cpu3, vultr-a100-20gb, lambda-gh200-1, lambda-gh200-8)
2026-01-16 22:57:58,360 - scripts.p2p.leadership_state_machine - INFO - LeadershipStateMachine initialized: node_id=local-mac, state=follower, epoch=0
2026-01-16 22:57:58,361 - p2p_orchestrator - INFO - MonitoringManager initialized
2026-01-16 22:57:58,373 - app.coordination.database_sync_manager - INFO - [EloSyncManager] Initialized for elo db=/Users/armand/Development/RingRift/ai-service/data/unified_elo.db, coordinator=nebius-backbone-1
2026-01-16 22:57:58,373 - p2p_orchestrator - INFO - EloSyncManager initialized (db: /Users/armand/Development/RingRift/ai-service/data/unified_elo.db)
2026-01-16 22:57:58,373 - p2p_orchestrator - INFO - PFSP opponent pools initialized for 4 configs
2026-01-16 22:57:58,373 - p2p_orchestrator - INFO - CMA-ES auto-tuners initialized for 4 configs
2026-01-16 22:57:58,373 - p2p_orchestrator - INFO - P2P protocols: MEMBERSHIP_MODE=hybrid (SWIM=available), CONSENSUS_MODE=hybrid (Raft=available)
2026-01-16 22:57:58,373 - scripts.p2p.consensus_mixin - WARNING - Raft consensus unavailable: no Raft partners available
2026-01-16 22:57:58,377 - scripts.p2p.transport_cascade - INFO - Registered transport: http_direct (tier TIER_1_FAST)
2026-01-16 22:57:58,377 - scripts.p2p.transport_cascade - INFO - Registered transport: tailscale (tier TIER_2_RELIABLE)
2026-01-16 22:57:58,377 - scripts.p2p.transport_cascade - INFO - Registered transport: ssh_tunnel (tier TIER_3_TUNNELED)
2026-01-16 22:57:58,377 - scripts.p2p.transport_cascade - INFO - Registered transport: cloudflare_tunnel (tier TIER_3_TUNNELED)
2026-01-16 22:57:58,401 - scripts.p2p.p2p_mixin_base - INFO - [peer_manager] Multi-relay failover enabled with 5 relays: hetzner-cpu3, vultr-a100-20gb, hetzner-cpu1... (preferred: hetzner-cpu2)
2026-01-16 22:57:58,401 - scripts.p2p.transport_cascade - INFO - Registered transport: p2p_relay (tier TIER_4_RELAY)
2026-01-16 22:57:58,401 - scripts.p2p.p2p_mixin_base - INFO - [peer_manager] Failover system initialized successfully
2026-01-16 22:57:58,401 - p2p_orchestrator - INFO - Failover system initialized (transport cascade + union discovery)
2026-01-16 22:57:58,403 - scripts.p2p.managers.state_manager - INFO - Loaded cluster epoch: 4504
2026-01-16 22:57:58,404 - p2p_orchestrator - INFO - Safeguards: rate_limit=5/min, load_max=2.0x, agent_mode=False
2026-01-16 22:57:58,408 - scripts.p2p.managers.state_manager - INFO - P0.5: Invalidated expired leader lease on startup. Old leader: vultr-a100-20gb, expired at: 0, now: 1768625878
2026-01-16 22:57:58,408 - scripts.p2p.managers.state_manager - INFO - Loaded state: 183 peers, 838 jobs
2026-01-16 22:57:58,409 - scripts.p2p.managers.state_manager - INFO - [StateManager] Cleaned stale state: removed 826 jobs, 182 peers
2026-01-16 22:57:58,409 - p2p_orchestrator - INFO - Loaded state: 1 peers, 12 jobs
2026-01-16 22:57:58,409 - p2p_orchestrator - INFO - [P2P] Startup state validation passed
2026-01-16 22:57:58,409 - scripts.p2p.managers.state_manager - INFO - [StateManager] Loaded 20 peer health records
2026-01-16 22:57:58,410 - p2p_orchestrator - INFO - [P2P] Loaded 20 peer health records
2026-01-16 22:57:59,436 - p2p_orchestrator - WARNING - [P2P] GPU node local-mac is marked as coordinator - this may be a misconfiguration. GPU: Apple MPS. Unset RINGRIFT_IS_COORDINATOR or remove role:coordinator from YAML to enable training capabilities.
2026-01-16 22:57:59,436 - p2p_orchestrator - INFO - [P2P] Coordinator-only mode: no selfplay/training/cmaes capabilities
2026-01-16 22:57:59,749 - scripts.p2p.managers.node_selector - INFO - [NodeSelector] Subscribed to HOST_OFFLINE
2026-01-16 22:57:59,749 - scripts.p2p.managers.node_selector - INFO - [NodeSelector] Subscribed to NODE_RECOVERED
2026-01-16 22:57:59,749 - scripts.p2p.managers.node_selector - INFO - [NodeSelector] Subscribed to HOST_ONLINE
2026-01-16 22:57:59,750 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to LEADER_ELECTED
2026-01-16 22:57:59,750 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to NODE_RECOVERED
2026-01-16 22:57:59,750 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to HOST_ONLINE
2026-01-16 22:57:59,750 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Event subscriptions complete (3 events)
2026-01-16 22:57:59,750 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to SELFPLAY_RATE_CHANGED
2026-01-16 22:57:59,750 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to EXPLORATION_BOOST
2026-01-16 22:57:59,750 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to TRAINING_COMPLETED
2026-01-16 22:57:59,750 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to ELO_VELOCITY_CHANGED
2026-01-16 22:57:59,750 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to NPZ_EXPORT_COMPLETE
2026-01-16 22:57:59,750 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to TRAINING_STARTED
2026-01-16 22:57:59,750 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to EVALUATION_COMPLETED
2026-01-16 22:57:59,750 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to PLATEAU_DETECTED
2026-01-16 22:57:59,750 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to EVALUATION_BACKPRESSURE
2026-01-16 22:57:59,750 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to EVALUATION_BACKPRESSURE_RELEASED
2026-01-16 22:57:59,750 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to TRAINING_BLOCKED_BY_QUALITY
2026-01-16 22:57:59,750 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to HYPERPARAMETER_UPDATED
2026-01-16 22:57:59,750 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to QUALITY_SCORE_UPDATED
2026-01-16 22:57:59,750 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to ARCHITECTURE_WEIGHTS_UPDATED
2026-01-16 22:57:59,751 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to DATA_STARVATION_CRITICAL
2026-01-16 22:57:59,751 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Event subscriptions complete (15 events)
2026-01-16 22:57:59,760 - p2p_orchestrator - INFO - [P2P] Seeded SelfplayScheduler with 12 config game counts from canonical DBs
2026-01-16 22:57:59,760 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to HOST_OFFLINE
2026-01-16 22:57:59,760 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to HOST_ONLINE
2026-01-16 22:57:59,760 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to NODE_RECOVERED
2026-01-16 22:57:59,760 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Event subscriptions complete (3 events)
2026-01-16 22:57:59,760 - p2p_orchestrator - INFO - [P2P] Spawn verification wired: JobManager <-> SelfplayScheduler
2026-01-16 22:57:59,760 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to SELFPLAY_COMPLETE
2026-01-16 22:57:59,760 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to DATA_SYNC_COMPLETED
2026-01-16 22:57:59,760 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to EVALUATION_COMPLETED
2026-01-16 22:57:59,760 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to REGRESSION_DETECTED
2026-01-16 22:57:59,760 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to TASK_ABANDONED
2026-01-16 22:57:59,760 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Subscribed to P2P_NODE_DEAD
2026-01-16 22:57:59,761 - scripts.p2p.p2p_mixin_base - INFO - [EventSubscriptionMixin] Event subscriptions complete (6 events)
2026-01-16 22:57:59,761 - p2p_orchestrator - INFO - [P2P] JobOrchestrationManager initialized
2026-01-16 22:57:59,761 - p2p_orchestrator - INFO - WorkDiscoveryManager: initialized with 4 discovery channels
2026-01-16 22:57:59,764 - app.coordination.cross_process_events - INFO - [CrossProcessEventPoller] Resuming from event_id 86587
2026-01-16 22:57:59,764 - app.coordination.curriculum_integration - INFO - [MomentumToCurriculumBridge] Subscribed to EVALUATION_COMPLETED, SELFPLAY_RATE_CHANGED, ELO_SIGNIFICANT_CHANGE, SELFPLAY_ALLOCATION_UPDATED, MODEL_PROMOTED, TIER_PROMOTION, CROSSBOARD_PROMOTION, CURRICULUM_ADVANCEMENT_NEEDED, ELO_VELOCITY_CHANGED, CURRICULUM_ADVANCED, CURRICULUM_PROPAGATE, REGRESSION_DETECTED, TRAINING_LOSS_ANOMALY, QUORUM_RECOVERY_STARTED, CURRICULUM_ROLLBACK
2026-01-16 22:57:59,765 - app.coordination.curriculum_integration - INFO - [MomentumToCurriculumBridge] Started (event-driven mode)
2026-01-16 22:57:59,765 - app.coordination.curriculum_integration - INFO - [PFSPWeaknessWatcher] Started
2026-01-16 22:57:59,765 - app.coordination.curriculum_router - INFO - [promotion_failed_curriculum_watcher] Subscribed to ['PROMOTION_FAILED']
2026-01-16 22:57:59,765 - app.coordination.curriculum_integration - INFO - [PromotionCompletedToCurriculumWatcher] Subscribed to PROMOTION_COMPLETED
2026-01-16 22:57:59,765 - app.coordination.curriculum_router - INFO - [quality_penalty_curriculum_watcher] Subscribed to ['QUALITY_PENALTY_APPLIED']
2026-01-16 22:57:59,767 - app.coordination.curriculum_router - INFO - [regression_critical_curriculum_watcher] Subscribed to ['REGRESSION_CRITICAL']
2026-01-16 22:57:59,767 - app.coordination.curriculum_router - INFO - [architecture_curriculum_bridge] Subscribed to ['ARCHITECTURE_WEIGHTS_UPDATED']
2026-01-16 22:57:59,767 - app.coordination.curriculum_integration - INFO - [QualityToTemperatureWatcher] Subscribed to quality events
2026-01-16 22:57:59,767 - app.training.curriculum_feedback - INFO - [CurriculumFeedback] Subscribed to CURRICULUM_ADVANCED + TRAINING_EARLY_STOPPED events
2026-01-16 22:57:59,767 - app.training.curriculum_feedback - INFO - [EloToCurriculumWatcher] Subscribed to ELO_UPDATED events
2026-01-16 22:57:59,767 - app.training.curriculum_feedback - INFO - [wire_elo_to_curriculum] ELO events wired to curriculum rebalance (threshold=30.0)
2026-01-16 22:57:59,767 - app.training.curriculum_feedback - INFO - [PlateauToCurriculumWatcher] Subscribed to PLATEAU_DETECTED events
2026-01-16 22:57:59,767 - app.training.curriculum_feedback - INFO - [wire_plateau_to_curriculum] PLATEAU_DETECTED events wired to curriculum rebalance (cooldown=600.0s, boost=0.3)
2026-01-16 22:57:59,767 - app.training.curriculum_feedback - INFO - [TournamentToCurriculumWatcher] Subscribed to EVALUATION_COMPLETED events
2026-01-16 22:57:59,767 - app.training.curriculum_feedback - INFO - [wire_tournament_to_curriculum] EVALUATION_COMPLETED events wired to curriculum (low=0.45, high=0.65)
2026-01-16 22:57:59,767 - app.training.curriculum_feedback - INFO - [PromotionToCurriculumWatcher] Subscribed to MODEL_PROMOTED events
2026-01-16 22:57:59,767 - app.training.curriculum_feedback - INFO - [wire_promotion_to_curriculum] PROMOTION_COMPLETE events wired to curriculum (failure_urgency=high)
2026-01-16 22:57:59,767 - app.training.curriculum_feedback - INFO - [QualityFeedbackWatcher] Subscribed to QUALITY_SCORE_UPDATED events
2026-01-16 22:57:59,767 - app.training.curriculum_feedback - INFO - [wire_quality_to_curriculum] Quality events wired to selfplay budget adjustment (window=100)
2026-01-16 22:57:59,769 - app.training.curriculum_feedback - INFO - [wire_epoch_to_curriculum] EPOCH_COMPLETED events wired to curriculum (check_interval=5 epochs)
2026-01-16 22:57:59,771 - app.training.curriculum_feedback - INFO - CurriculumFeedback: OpponentWinRateTracker integrated
2026-01-16 22:57:59,771 - app.training.curriculum_feedback - INFO - Wired OpponentWinRateTracker to CurriculumFeedback
2026-01-16 22:57:59,771 - app.training.curriculum_feedback - INFO - [wire_all_curriculum_feedback] Wired opponent tracker to curriculum
2026-01-16 22:57:59,772 - app.training.curriculum_feedback - INFO - [EarlyStopToCurriculumWatcher] Subscribed to TRAINING_EARLY_STOPPED events
2026-01-16 22:57:59,772 - app.training.curriculum_feedback - INFO - [wire_early_stop_to_curriculum] TRAINING_EARLY_STOPPED events wired to curriculum boost
2026-01-16 22:57:59,772 - app.training.curriculum_feedback - INFO - [wire_all_curriculum_feedback] Wired 8 curriculum feedback integrations
2026-01-16 22:57:59,772 - app.coordination.curriculum_integration - INFO - [wire_all_feedback_loops] Wired 9 feedback integrations: momentum_bridge, pfsp_weakness, promotion_failed_curriculum, promotion_completed_curriculum, quality_penalty_curriculum, regression_critical_curriculum, architecture_curriculum, quality_temperature, curriculum_feedback
2026-01-16 22:57:59,772 - p2p_orchestrator - WARNING - Feedback loops: partial wiring - Unknown error
2026-01-16 22:57:59,772 - p2p_orchestrator - INFO - Subscribed to daemon status events
2026-01-16 22:57:59,772 - p2p_orchestrator - INFO - Subscribed to training feedback signals
2026-01-16 22:57:59,772 - p2p_orchestrator - INFO - Subscribed to manager lifecycle and health events
2026-01-16 22:57:59,772 - p2p_orchestrator - INFO - [P2P] Event subscriptions: daemon=✓, feedback=✓, manager=✓
[P2P] Initialized node local-mac on 0.0.0.0:8770 (advertise 100.69.164.58:8770)
2026-01-16 22:57:59,772 - p2p_orchestrator - INFO - RingRift path: /Users/armand/Development/RingRift
2026-01-16 22:57:59,772 - p2p_orchestrator - INFO - Version: main@ae9207bc4
2026-01-16 22:57:59,772 - p2p_orchestrator - INFO - Known peers: ['100.94.174.19:8770', '100.110.28.41:8770', '100.94.201.92:8770', '100.67.131.72:8770', '100.126.21.102:8770']
2026-01-16 22:57:59,772 - p2p_orchestrator - INFO - Auth: disabled (set RINGRIFT_CLUSTER_AUTH_TOKEN to enable)
2026-01-16 22:57:59,772 - p2p_orchestrator - INFO - HybridTransport: enabled (HTTP with SSH fallback for Vast)
2026-01-16 22:57:59,773 - app.p2p.swim_adapter - INFO - SWIM seeds from cluster_config: [('100.94.174.19', 7947), ('100.67.131.72', 7947), ('100.126.21.102', 7947), ('100.94.201.92', 7947), ('100.71.89.91', 7947), ('100.121.230.110', 7947)]
2026-01-16 22:57:59,773 - p2p_orchestrator - INFO - SWIM membership manager initialized for local-mac
2026-01-16 22:57:59,773 - p2p_orchestrator - INFO - LoopManager: initialized for extracted background loops
2026-01-16 22:57:59,774 - p2p_orchestrator - INFO - [P2P] Manager health: 0/8 healthy, 8 starting (grace period: 58s remaining)
2026-01-16 22:57:59,774 - p2p_orchestrator - INFO - P2P orchestrator initialized successfully: local-mac
2026-01-16 22:57:59,774 - p2p_orchestrator - INFO - [P2P] Event emitters available - P2P events will be published
2026-01-16 22:57:59,774 - p2p_orchestrator - INFO - Starting P2P orchestrator main loop: local-mac
2026-01-16 22:57:59,775 - p2p_orchestrator - INFO - Started isolated health server thread (port 8772)
2026-01-16 22:57:59,775 - p2p_orchestrator - INFO - [Startup Validation] SWIM protocol available (membership_mode=hybrid)
2026-01-16 22:57:59,776 - p2p_orchestrator - INFO - [Startup Validation] Raft protocol available (consensus_mode=hybrid)
2026-01-16 22:57:59,776 - p2p_orchestrator - INFO - [Startup Validation] Protocol config: membership=hybrid, consensus=hybrid
2026-01-16 22:57:59,776 - p2p_orchestrator - INFO - Isolated health server started on 0.0.0.0:8772
2026-01-16 22:58:00,317 - p2p_orchestrator - INFO - [Startup Validation] Voter quorum OK: 6/7 voters reachable
2026-01-16 22:58:00,317 - scripts.p2p.resource_detector - WARNING - [ResourceDetector] GPU detected (Apple MPS) but PyTorch has no CUDA support. Fix: pip install torch --index-url https://download.pytorch.org/whl/cu128
2026-01-16 22:58:00,317 - p2p_orchestrator - WARNING - [Startup Validation] GPU detected (Apple MPS) but PyTorch has no CUDA support. Fix: pip install torch --index-url https://download.pytorch.org/whl/cu128
/Users/armand/Development/RingRift/ai-service/scripts/p2p_orchestrator.py:29236: DeprecationWarning: get_event_bus() from data_events is deprecated. Use get_router() from app.coordination.event_router instead.
  get_event_bus().emit(
2026-01-16 22:58:00,317 - p2p_orchestrator - WARNING - [Startup Validation] Completed with 1 warnings. Managers: 2/3 available
2026-01-16 22:58:00,321 - scripts.p2p.routes - WARNING - Missing 2 handlers: ['handle_probe_vast_nodes', 'handle_gpu_rankings']...
2026-01-16 22:58:00,321 - p2p_orchestrator - INFO - Registered 192 HTTP routes from route registry
2026-01-16 22:58:00,322 - scripts.p2p.handlers.file_download - INFO - Registered 5 file transfer routes (4 download, 1 upload)
2026-01-16 22:58:00,322 - p2p_orchestrator - INFO - Registered 5 file download routes for HTTP-based sync
2026-01-16 22:58:00,322 - scripts.p2p.handlers.network_health - INFO - Registered network health routes: /network/health, /network/reconnect, /network/status
2026-01-16 22:58:00,322 - scripts.p2p.handlers.models - INFO - [ModelHandler] Registered 2 model routes
2026-01-16 22:58:00,322 - p2p_orchestrator - INFO - Registered 2 model inventory routes
2026-01-16 22:58:00,339 - scripts.verify_nfs_sync - WARNING - Could not auto-detect NFS root. Set RINGRIFT_NFS_PATH environment variable.
2026-01-16 22:58:00,339 - scripts.verify_nfs_sync - INFO - NFS not configured, skipping sync verification
2026-01-16 22:58:00,341 - app.distributed.cluster_manifest - INFO - ClusterManifest initialized: node=MacBook-Pro-5.local, db=/Users/armand/Development/RingRift/ai-service/data/cluster_manifest.db
2026-01-16 22:58:00,341 - app.distributed.cluster_manifest - INFO - [ClusterManifest] Subscribed to real-time events (NEW_GAMES_AVAILABLE, GAMES_UPLOADED_TO_S3, GAMES_UPLOADED_TO_OWC, BACKUP_COMPLETED)
2026-01-16 22:58:00,341 - app.coordination.sync_router - INFO - [SyncRouter] External storage configured: mac-studio -> /Volumes/RingRift-Data
2026-01-16 22:58:00,341 - app.coordination.sync_router - INFO - SyncRouter initialized: 22 nodes, S3 enabled=True
2026-01-16 22:58:00,341 - p2p_orchestrator - INFO - SyncRouter: initialized for intelligent data routing
2026-01-16 22:58:00,341 - app.coordination.sync_router - INFO - [SyncRouter] Wired to event router (NEW_GAMES_AVAILABLE, TRAINING_STARTED, HOST_ONLINE/OFFLINE, NODE_RECOVERED, CLUSTER_CAPACITY_CHANGED, MODEL_SYNC_REQUESTED, SYNC_STALLED, SYNC_FAILURE_CRITICAL, BACKPRESSURE_ACTIVATED/RELEASED, CONFIG_UPDATED)
2026-01-16 22:58:00,341 - p2p_orchestrator - INFO - SyncRouter: wired to event system
2026-01-16 22:58:00,341 - p2p_orchestrator - INFO - ULSM: Leadership state machine broadcast callback wired
2026-01-16 22:58:00,342 - p2p_orchestrator - INFO - HTTP server started on 0.0.0.0:8770 (IPv4, backlog=1024)
2026-01-16 22:58:00,342 - p2p_orchestrator - INFO - HTTP server also listening on [::]:8770 (IPv6)
2026-01-16 22:58:01,359 - app.coordination.resource_optimizer - INFO - Loaded PID config from /Users/armand/Development/RingRift/ai-service/config/unified_loop.yaml: kp=0.3, ki=0.05, kd=0.1
2026-01-16 22:58:01,458 - app.coordination.resource_optimizer - INFO - ResourceOptimizer initialized: node=local-mac, target=60.0-80.0%
2026-01-16 22:58:02,832 - aiohttp.access - INFO - 100.100.19.96 [16/Jan/2026:22:58:01 -0600] "GET /relay/peers HTTP/1.1" 200 1953 "-" "Python/3.10 aiohttp/3.13.2"
2026-01-16 22:58:02,850 - p2p_orchestrator - INFO - [P2P] Startup announcement discovered peer: hetzner-cpu1
2026-01-16 22:58:04,541 - p2p_orchestrator - INFO - [P2P] Startup announcement discovered peer: nebius-backbone-1
2026-01-16 22:58:05,322 - aiohttp.access - INFO - 100.67.131.72 [16/Jan/2026:22:58:05 -0600] "GET /health HTTP/1.1" 200 727 "-" "Python/3.10 aiohttp/3.13.2"
2026-01-16 22:58:05,323 - p2p_orchestrator - INFO - First-contact peer registered: lambda-gh200-10 (caps: ['selfplay', 'training', 'cmaes', 'large_boards'])
2026-01-16 22:58:06,095 - aiohttp.access - INFO - 100.100.19.96 [16/Jan/2026:22:58:05 -0600] "POST /heartbeat HTTP/1.1" 200 2208 "-" "Python/3.10 aiohttp/3.13.2"
2026-01-16 22:58:06,103 - scripts.p2p.p2p_mixin_base - INFO - [sync_planner] HOST_ONLINE: lambda-gh200-10, invalidating cluster manifest
2026-01-16 22:58:06,103 - scripts.p2p.p2p_mixin_base - INFO - [job_manager] HOST_ONLINE: lambda-gh200-10, node available for jobs
2026-01-16 22:58:06,104 - app.coordination.sync_router - INFO - [SyncRouter] Added new node: 100.100.19.96
2026-01-16 22:58:06,107 - aiohttp.access - INFO - 100.110.28.41 [16/Jan/2026:22:58:06 -0600] "GET /health HTTP/1.1" 200 727 "-" "Python/3.12 aiohttp/3.13.2"
2026-01-16 22:58:06,189 - app.coordination.node_policies - INFO - Loaded 5 node policies, 0 overrides
2026-01-16 22:58:06,191 - app.coordination.work_queue - INFO - Work queue database initialized at /Users/armand/Development/RingRift/ai-service/data/work_queue.db
2026-01-16 22:58:06,253 - app.coordination.work_queue - INFO - Loaded 4143 work items from database
2026-01-16 22:58:06,255 - app.coordination.work_queue - INFO - [WorkQueue] Restored backpressure active state from DB (pending=4143)
2026-01-16 22:58:06,486 - aiohttp.access - INFO - 100.115.97.24 [16/Jan/2026:22:58:06 -0600] "GET /status HTTP/1.1" 200 18602 "-" "Python/3.11 aiohttp/3.12.14"
2026-01-16 22:58:07,772 - aiohttp.access - INFO - ::1 [16/Jan/2026:22:58:07 -0600] "GET /status HTTP/1.1" 200 18603 "-" "curl/8.7.1"
2026-01-16 22:58:08,695 - p2p_orchestrator - INFO - [P2P] Startup announcement discovered peer: vultr-a100-20gb
2026-01-16 22:58:10,361 - p2p_orchestrator - INFO - [P2P] Startup announcement discovered peer: hetzner-cpu2
2026-01-16 22:58:12,264 - p2p_orchestrator - INFO - [P2P] Startup announcement discovered peer: hetzner-cpu3
2026-01-16 22:58:12,264 - p2p_orchestrator - INFO - [P2P] Startup announcements: 5/5 peers reachable
2026-01-16 22:58:12,264 - p2p_orchestrator - INFO - [LoopManager] Phase 4 startup: EXTRACTED_LOOPS_ENABLED=True
2026-01-16 22:58:12,264 - p2p_orchestrator - INFO - [LoopManager] _register_extracted_loops called, already_registered=False
2026-01-16 22:58:12,264 - p2p_orchestrator - INFO - [LoopManager] Got manager: <scripts.p2p.loops.base.LoopManager object at 0x131efb130>
2026-01-16 22:58:12,265 - p2p_orchestrator - INFO - [P2P] SpawnVerificationLoop enabled for job spawn tracking
2026-01-16 22:58:12,265 - p2p_orchestrator - INFO - [P2P] PredictiveScalingLoop enabled for proactive job spawning
2026-01-16 22:58:12,265 - p2p_orchestrator - INFO - [P2P] JobReassignmentLoop enabled for faster orphaned job recovery
2026-01-16 22:58:12,267 - scripts.p2p.adapters.scale_adapters - INFO - CompositeScaleAdapter initialized with providers: []
2026-01-16 22:58:12,267 - p2p_orchestrator - INFO - [P2P] AutoScalingLoop enabled with reluctant termination
2026-01-16 22:58:12,267 - p2p_orchestrator - INFO - ModelFetchLoop: registered for training node model fetching
2026-01-16 22:58:12,267 - p2p_orchestrator - INFO - [LoopManager] TailscalePeerDiscoveryLoop registered
2026-01-16 22:58:12,267 - p2p_orchestrator - INFO - [LoopManager] PeerCleanupLoop registered
2026-01-16 22:58:12,267 - p2p_orchestrator - INFO - [LoopManager] GossipStateCleanupLoop registered
2026-01-16 22:58:12,267 - p2p_orchestrator - INFO - [LoopManager] QuorumCrisisDiscoveryLoop registered
2026-01-16 22:58:12,268 - p2p_orchestrator - INFO - [LoopManager] WorkerPullLoop registered (with work discovery manager)
2026-01-16 22:58:12,268 - p2p_orchestrator - INFO - [LoopManager] RemoteP2PRecoveryLoop registered (node: local-mac, leader-only execution)
2026-01-16 22:58:12,268 - p2p_orchestrator - INFO - [LoopManager] LeaderProbeLoop registered (fast leader recovery)
2026-01-16 22:58:12,268 - p2p_orchestrator - INFO - [LoopManager] RelayHealthLoop registered (NAT relay monitoring)
2026-01-16 22:58:12,268 - p2p_orchestrator - INFO - [P2P] TrainingSyncLoop registered (critical for training pipeline)
2026-01-16 22:58:12,268 - p2p_orchestrator - INFO - [P2P] DataAggregationLoop registered (important for training data)
2026-01-16 22:58:12,268 - p2p_orchestrator - INFO - [P2P] HealthAggregationLoop registered with auto-recovery (Session 17.26)
2026-01-16 22:58:12,268 - p2p_orchestrator - INFO - [P2P] IpDiscoveryLoop registered (handles dynamic IPs)
2026-01-16 22:58:12,268 - p2p_orchestrator - INFO - [P2P] TailscaleRecoveryLoop registered (handles Tailscale failures)
2026-01-16 22:58:12,268 - p2p_orchestrator - INFO - [P2P] TailscaleKeepaliveLoop registered (userspace_mode=True, interval=30.0s)
2026-01-16 22:58:12,268 - p2p_orchestrator - INFO - [P2P] ClusterHealingLoop registered (interval=300.0s, max_heal=5)
2026-01-16 22:58:12,268 - p2p_orchestrator - INFO - [P2P] UdpDiscoveryLoop registered (LAN peer discovery)
2026-01-16 22:58:12,268 - p2p_orchestrator - INFO - [P2P] SplitBrainDetectionLoop registered (partition detection)
2026-01-16 22:58:12,268 - p2p_orchestrator - INFO - [P2P] AutonomousQueuePopulationLoop registered (fallback queue population)
2026-01-16 22:58:12,268 - p2p_orchestrator - INFO - [P2P] HttpServerHealthLoop registered (with graceful restart support)
2026-01-16 22:58:12,268 - p2p_orchestrator - INFO - [P2P] ComprehensiveEvaluationLoop registered (6-hour model evaluation cycle)
2026-01-16 22:58:12,269 - p2p_orchestrator - INFO - [P2P] TournamentDataPipelineLoop registered (hourly tournament data export)
2026-01-16 22:58:12,269 - p2p_orchestrator - INFO - [P2P] CircuitBreakerDecayLoop registered (enabled=True, ttl=3600.0s)
2026-01-16 22:58:12,269 - p2p_orchestrator - INFO - LoopManager: registered 40 loops
2026-01-16 22:58:12,269 - scripts.p2p.loops.base - INFO - [p2p_loops] Starting 40 loops in order: ['queue_populator', 'elo_sync', 'job_reaper', 'idle_detection', 'spawn_verification', 'predictive_scaling', 'job_reassignment', 'auto_scaling', 'work_queue_maintenance', 'nat_management', 'manifest_collection', 'data_management', 'model_sync', 'model_fetch', 'validation', 'tailscale_peer_discovery', 'peer_cleanup', 'gossip_state_cleanup', 'quorum_crisis_discovery', 'worker_pull', 'follower_discovery', 'self_healing', 'remote_p2p_recovery', 'leader_probe', 'relay_health', 'predictive_monitoring', 'training_sync', 'data_aggregation', 'health_aggregation', 'ip_discovery', 'tailscale_recovery', 'tailscale_keepalive', 'cluster_healing', 'udp_discovery', 'split_brain_detection', 'autonomous_queue_population', 'http_server_health', 'comprehensive_evaluation', 'tournament_data_pipeline', 'circuit_breaker_decay']
2026-01-16 22:58:12,269 - p2p_orchestrator - INFO - Sending initial heartbeat burst to known peers
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     2026-01-16 22:57:57,438 - p2p_orchestrator - WARNING - Forced shutdown (second SIGTERM) after 337.5s uptime
