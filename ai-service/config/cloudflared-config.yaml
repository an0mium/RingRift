# Cloudflare Tunnel Configuration for RingRift Cluster
# Deploy to: /etc/cloudflared/config.yml on tunnel nodes
#
# This configuration routes traffic from Cloudflare to the P2P cluster
# The tunnel connects outbound (no exposed ports) and Cloudflare handles SSL
#
# Tunnel Details:
#   Name: ringrift-dashboard
#   ID: 02a725cf-3519-474f-ab16-d40c3aa1edae
#   Created: December 30, 2025
#
# Nodes running this tunnel:
#   - nebius-backbone-1 (primary, 100.110.28.41)
#   - hetzner-cpu1 (backup, 100.94.174.19)
#
# Public URLs:
#   - https://dashboard.ringrift.ai/ - Cluster dashboard
#   - https://p2p.ringrift.ai/status - P2P status API
#   - https://queue.ringrift.ai/ - Work queue dashboard
#
# Setup Instructions:
#   1. Copy credentials file from primary node
#   2. Run scripts/setup_cloudflare_tunnel.sh on new node
#   Or manually:
#   1. Install cloudflared
#   2. Copy ~/.cloudflared/02a725cf-3519-474f-ab16-d40c3aa1edae.json
#   3. Copy this config to /etc/cloudflared/config.yml
#   4. Start: systemctl enable --now cloudflared

tunnel: 02a725cf-3519-474f-ab16-d40c3aa1edae
credentials-file: ~/.cloudflared/02a725cf-3519-474f-ab16-d40c3aa1edae.json

ingress:
  # Main dashboard - routes to P2P leader via Tailscale
  - hostname: dashboard.ringrift.ai
    service: http://100.94.201.92:8770

  # P2P API endpoint
  - hostname: p2p.ringrift.ai
    service: http://100.94.201.92:8770

  # Work queue dashboard
  - hostname: queue.ringrift.ai
    service: http://100.94.201.92:8770

  # Catch-all (required by cloudflared)
  - service: http_status:404
